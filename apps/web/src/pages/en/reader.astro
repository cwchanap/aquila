---
import MainLayout from '@/layouts/main.astro';
import { getTranslations, type Locale } from '@aquila/dialogue';

const locale = ((Astro.currentLocale as string | undefined) ?? 'en') as Locale;
const translations = getTranslations(locale);
const title = translations.reader.title;
---

<MainLayout title={title}>
    <div id="reader-container" class="min-h-screen" data-locale={translations.locale}>
        <!-- Reader will be mounted here -->
    </div>

    <script>
        import { ReaderManager } from '@/lib/reader-manager';

        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('reader-container');
            if (!container) {
                console.warn('Reader container element not found');
                return;
            }
            const attr = container.getAttribute('data-locale');
            const locale = attr === 'zh' || attr === 'en' ? attr : 'en';
            const manager = new ReaderManager(locale);
            manager.initialize();
        });
    </script>
</MainLayout>
